!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.gallery=n()}(this,function(){"use strict";var t=["webkit","moz","ms","o"],K=t.reduce(function(t,n){return t||window[n+"RequestAnimationFrame"]},window.requestAnimationFrame).bind(window),Q=t.reduce(function(t,n){return t||window[n+"CancelAnimationFrame"]},window.cancelAnimationFrame).bind(window);if(!K||!Q){var e=0;K=function(t){var n=+new Date;return e=Math.max(n,e+16),setTimeout(t,e-n)},Q=clearTimeout}function n(t){var n=!1;function e(){}var r=Object.defineProperty({},"passive",{get:function(){n=!0}});return window.addEventListener("testPassive",e,r),window.removeEventListener("testPassive",e,r),n}var i=!!n()&&{capture:!1,passive:!0},T=function(t,n,e,r){return void 0===r&&(r=i),t.addEventListener(n,e,r),function(){return w(t,n,e,r)}},w=function(t,n,e,r){return void 0===r&&(r=i),t.removeEventListener(n,e,r)},j=function(r){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];return t.reduce(function(t,n,e){return t+n+r[e+1]},r[0])},k="_src_style_css_bg",R="_src_style_css_wrap",C="_src_style_css_swiper",D="_src_style_css_disableTransition",q=Object.freeze(['\n      <div class="','">\n        <div class="','">\n          <img data-gallery-index="','" src="','" style="width: ',"px; height: ",'px;"/>\n        </div>\n      </div>\n    ']),I=Object.freeze(['\n<div class="','">\n  <div class="','"></div>\n  <div class="','">\n    <div class="','">\n    ',"\n    </div>\n  </div>\n</div>\n"]);document.documentElement;var x=function(t){return{x:t.pageX,y:t.pageY}};function S(e){var r,n,i,o,t,a,u=window.phase=(r=0,n=1,i={idle:0},o=function(t){return"number"==typeof t?t:i[t]},t=function(e,t){return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return t.forEach(function(t){return e(t)}),a}},a={v:function(){return r},or:t(function(t){return r|=o(t)}),rm:t(function(t){return r&=~o(t)}),add:t(function(t){i[t]=n,n<<=1}),is:function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return t.reduce(function(t,n){return t&&!!(r&o(n))},!0)},set:function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return r=t.reduce(function(t,n){return t|o(n)},0),a}},a).add("start","move","end","scroll","pinch","pan"),s=!1,c=0,l=-1,f=-1,d={tap:[],single:[],double:[],start:[],move:[],end:[],scroll:[],scrollend:[],pan:[],panstart:[],panend:[],pinch:[],pinchstart:[],pinchend:[]},h={},p={start:[],last:[],current:[]},v=function(t){return d[t].forEach(function(t){return t(p,h,u)})},y=function(){s&&(K(y),v("move"),u.is("scroll")&&v("scroll"),u.is("pinch")&&v("pinch"),u.is("pan")&&v("pan"))},m=function(n,t){if(e=t,Array.isArray(e)||e instanceof Array)return t.forEach(function(t){return m(n,t)});var e;"string"==typeof t&&(p[t][0]=x(n.touches[0])),1<n.touches.length?p[t][1]=x(n.touches[1]):p[t].splice(1,10)};return T(e,"touchstart",function(t){m(t,["start","last","current"]),h=t.target,u.set("start"),1<t.touches.length&&u.or("pinch"),v("start"),u.is("pinch")?v("pinchstart"):v("panstart"),u.is("pinch")||(l=Date.now())}),T(e,"touchmove",function(t){p.last=p.current,m(t,"current"),1<t.touches.length?u.rm("pan").or("pinch"):(u.is("pinch")&&(m(t,"start"),v("start")),u.rm("pinch").or("pan")),u.is("start")&&!u.is("pinch")&&Math.abs(p.current[0].x-p.start[0].x)<Math.abs(p.current[0].y-p.start[0].y)&&u.or("scroll"),u.rm("start").or("move"),s||(s=!0,y())}),T(e,"touchend",function(t){if(u.rm("start","move").or("end"),v("end"),u.is("scroll")&&v("scrollend"),u.is("pinch")&&v("pinchend"),u.is("pan")&&v("panend"),s=!1,!u.is("pinch")&&!u.is("pan")){var n=Date.now();n-l<=200&&(v("tap"),c=n-f<=300?c+1:1,f=n,1===c?setTimeout(function(){return 1===c&&v("single")},300):2===c&&v("double"))}}),{on:function(t,n){return d[t].push(n),function(){return w(e,t,n)}},off:function(t,n){return d[t].splice(d[t].indexOf(n),1)}}}function Z(t){var n=this;t.forEach(function(t){return n.append(t)})}Z.prototype.append=function(t){var n=t.$next=t.$prev=t;return this.$tail?(n.$prev=this.$tail,n.$next=this.$tail.$next,(this.$tail.$next=n).$next.$prev=n,this.$tail=n):this.$head=this.$tail=n};var tt=function(t,n,e){t.addEventListener(n,e,!1)},nt=function(t,n,e){t.removeEventListener(n,e,!1)},et=function(t){return"function"==typeof t},rt=function(t){var n=t.getBoundingClientRect();return n.top<window.innerHeight&&0<n.bottom&&n.left<window.innerWidth&&0<n.right},it={cubic:function(t){return--t*t*t+1},circ:function(t){return Math.sqrt(1-Math.pow(t-1,2))}},ot="touchstart",at="touchmove",ut="touchend",st=function(t,n){return window.getComputedStyle(t,null).getPropertyValue(n)};function ct(){this.value=0}ct.prototype={is:function(t){return this.value&t},or:function(t){return this.value=this.value|t,this},rm:function(t){return this.value=this.value&~t,this},set:function(t){return this.value=t,this}};var lt={root:null,rootMargin:"0px",threshold:[0,.01]},ft=!!window.IntersectionObserver,dt=(n(),{auto:!1,cycle:!0,expose:!1,root:null,elms:[],index:0,width:window.screen.width,height:200,css:!1,ease:"cubic",plugins:[],initHandlers:[],startHandlers:[],moveHandlers:[],endHandlers:[],animationEndHandlers:[]}),ht=document.createElement("div");function W(t){var a=Object.assign({},dt,t),u=a.index,s=a.root,l=a.elms,c=a.width,f=a.height,d=a.cycle,h=(a.expose,a.auto),p=a.css,v=a.ease;a.plugins.forEach(function(n){return Object.keys(n).forEach(function(t){return a[t+"Handlers"].push(n[t])})});var n=function(r){return function(){for(var t=arguments,n=[],e=arguments.length;e--;)n[e]=t[e];return a[r+"Handlers"].forEach(function(t){return t.apply(null,n)})}},y=n("init"),e=n("start"),i=n("move"),m=n("end");if(s){p&&(c=Number(st(s,"width").slice(0,-2)),f=Number(st(s,"height").slice(0,-2)));var w=s.children[0],x={main:-1,auto:-1},g=c/3,b={idle:0,start:1,drag:2,animate:4,scroll:8,auto:16,cancel:32},$=new ct,r=0,_=0,o=0,E=0,z=0,M=0,H=0,N=0,A=[],L=!1;h=d&&h;var O=l[u],T=function(t,n){var e,r;t.x=n,r=n,(e=t)&&(e.style.transition=e.style.webkitTransition="",e.style.transform=e.style.webkitTransform="translate3d("+r+"px, 0, 0)",i(O.$index,O,w,l))},j=function(t){return ht.appendChild(t)},k=function(t){return w.appendChild(t)},R=function(t){return!d&&M<H&&O===A.$head},C=function(t){return!d&&H<=M&&O===A.$tail},D=function(t){return clearTimeout(x.auto)},q=function(t){return D($.set(b.cancel))},I=function(t){D(),Q(x.main)};return function(){if(0===l.length)return y(-1);s.style.position="relative",p||(s.style.width=c+"px",s.style.height=f+"px");var t=2===l.length&&d;t&&(l.push(l[0].cloneNode(!0)),k(l[2]),l.push(l[1].cloneNode(!0)),k(l[3]),l[0].$index=l[2].$index=0,l[1].$index=l[3].$index=1);var n=1===l.length;if(L=2===l.length,A=new Z(l),t||l.forEach(function(t,n){return t.$index=n}),T(O,0),n||L||T(O.$prev,-c),n||T(O.$next,c),l.forEach(function(t){t.style.position="absolute",p||(t.style.width=c+"px",t.style.height=f+"px"),L||n||t===O||t===O.$prev||t===O.$next||j(t)}),n)return y(O.$index,O,w,l);if(L||d||0!==u||j(O.$prev),L||d||u!==l.length-1||j(O.$next),J(),tt(s,ot,S),tt(s,at,W),tt(s,ut,G),h){if(ft)K(function(){a.unobserve=function(t,n){if(!ft)return n();var e=new IntersectionObserver(n,lt);return e.observe(t),function(){e.unobserve(t)}}(s,function(t){t&&0===t[0].intersectionRatio?q():B()})});else{var e=function(){return rt(s)?U():q()};tt(window,"touchmove",function(){return rt(s)||q()}),tt(window,"touchend",e),e()}var r=["webkit","moz","ms","-"].reduce(function(t,n){return void 0!==document[t[0]]?t:[n+"Hidden",n+"visibilitychange"]},["hidden","visibilitychange"]),i=r[0],o=r[1];"-"!==i[0]&&document.addEventListener(o,function(){return document[i]?q():U()},!1)}w.x=0,y(O.$index,O,w,l)}(),{destroy:J,index:function(t){return O.$index},on:function(t,n){var e=a[t+"Handlers"];return e.push(n),function(){return e.splice(e.indexOf(n),1)}}}}function S(t){I(),$.or(b.start).rm(b.scroll),o=0;var n=t.touches[0];z=Date.now(),_=H=M=n.pageX,N=n.clientY,e(O.$index,O,w,l)}function W(t){if(!$.is(b.scroll)){var n=t.touches[0],e=n.pageX-H;if($.is(b.start)&&2*Math.abs(e)<Math.abs(n.clientY-N))$.or(b.scroll).rm(b.start);else{var r=0<e?1:-1;o!==r&&(_=H,z=Date.now(),o=r),$.set(b.drag),H=n.pageX,T(w,E+=e),t.preventDefault()}}}function X(){L||j(O.$next),O=O.$prev,R()||(T(O.$prev,O.x-c),k(O.$prev))}function F(){L||j(O.$prev),O=O.$next,C()||(T(O.$next,O.x+c),k(O.$next))}function P(){0===r&&-O.x-E>c/2&&(r=1,F())}function U(){D(),x.auto=setTimeout(function(){Y()},3e3)}function Y(){r=0,$.set(b.auto),e(O.$index,O,w,l),V(w,E,-O.x-c,2e3/3,P,U)}function B(){3<Math.abs(E+O.x)?Y():U()}function G(t){if($.is(b.scroll)&&!$.is(b.animate)&&!$.is(b.auto))return h&&B();$.set(b.animate);var n=_<H,e=Date.now()-z<120;if(!R()&&!C()){var r=O.x+E;e?n&&0<r?X():!n&&r<0&&F():g<r?X():r<-g&&F()}var i=-1*O.x,o=Math.min(Math.max(1e3*Math.abs(i-E)/c,250),2e3/3);V(w,E,i,e?250:o,null,h?function(){return B()}:null)}function V(r,i,o,a,u,s){var c=Date.now();!function t(){var n=Date.now()-c;if(a<=n&&(E=o),et(u)&&u(),a<=n)return T(r,o),!$.is(b.cancel)&&et(s)&&s(),$.set(b.idle),m(O.$index,O,w,l);var e=(o-i)*it[v](n/a)+i;T(r,E=e),x.main=K(t)}()}function J(){I(),et(a.unobserve)&&a.unobserve(),nt(s,ot,S),nt(s,at,W),nt(s,ut,G)}}ht.style.display="none",document.body.appendChild(ht);var X=function(t,n,e,r){return t.style.transform="translate3d("+n+"px,"+e+"px,0) scale("+r+")"},F=function(t,n){return t.style.opacity=n},r=document.documentElement,P=function(){return r.clientHeight},U=function(){return r.clientWidth},Y=function(t){return setTimeout(t,353)},B=function(t){return t.getBoundingClientRect()},G=function(t,n){return{x:.5*(t.x+n.x),y:.5*(t.y+n.y)}},o=function(t){return t*t},V=function(t,n){return Math.sqrt(o(t.x-n.x)+o(t.y-n.y))},J={selector:"data-gallery-item",dataset:"galleryItem"};return function(t){var n=Object.assign({},J,t),l=[],f=function(t){return l[Number(t.dataset.galleryIndex)]},d={init:{x:0,y:0,z:1,w:0,h:0},start:{x:0,y:0,z:1,w:0,h:0},last:{x:0,y:0,z:1,w:0,h:0},current:{x:0,y:0,z:1,w:0,h:0}},r=n.selector,i=n.dataset,o=document.createElement("div");document.body.appendChild(o);var h,p,a,e=!1,u=[],s=function(t){return u.push(t)};s(T(document,"click",function(t){var n=t.target;if("IMG"===n.tagName&&i in n.dataset){l.splice(0,l.length),document.querySelectorAll("img["+r+"]").forEach(function(t,n){t.dataset.galleryIndex=n;var e,r,i,o,a,u,s=t.naturalWidth,c=t.naturalHeight;l[n]={elm:t,w:s,h:c,r:s/c,src:t.src,i:n},l[n].shape=(e=f(t),r=U(),i=P(),o=r/i>e.r,a=o?i*e.r:r,u=o?i:r/e.r,{x:o?(r-a)/2:0,y:o?0:(i-u)/2,w:a,h:u,z:1})});var e=f(n);d.init=e.shape,o.innerHTML=j(I,"_src_style_css_gallery",k,C,"_src_style_css_swiperWrap",l.map(function(t){return j(q,"_src_style_css_swiperItem",R,t.i,t.src,t.shape.w,t.shape.h)}).join("")),K(function(){return function(e){var t=e.elm;c=o.childNodes[1],p=c.querySelector("."+k),a=c.querySelector("."+C);var r=B(t);y(),l.forEach(function(t){t.wrap=c.querySelector("."+R+' img[data-gallery-index="'+t.i+'"]').parentElement,t.i===e.i?X(t.wrap,r.left,r.top,r.width/d.init.w):X(t.wrap,t.shape.x,t.shape.y,1);var n=S(t.wrap);s(n.on("single",b)),s(n.on("double",$)),s(n.on("scroll",_)),s(n.on("scrollend",E)),s(n.on("pinch",z)),s(n.on("pinchend",M)),s(n.on("pan",A)),s(n.on("start",H)),s(n.on("move",N)),s(n.on("end",L))}),h=e.wrap,W({root:a,elms:Array.prototype.slice.apply(a.children[0].children),auto:!1,index:e.i}).on("end",function(t){h=l[t].wrap,d.init=l[t].shape}),c.style.display="block",K(function(){x()})}(e)})}}));var c,v=function(){return t=c,n=new RegExp("(\\s|^)"+D+"(\\s|$)"),void(t.className=t.className.replace(n," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));var t,n},y=function(){return r=n=D,void((e=t=c).className&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(e.className)||(t.className+=(t.className?" ":"")+n));var t,n,e,r},m="";return c={destroy:w};function w(){u.splice(1,u.length).forEach(function(t){return t()})}function x(t){v(),X(h,d.init.x,d.init.y,1),F(p,1),Y(function(){return e=!!y()})}function g(t){if(!e){e=!0,v();var n=B(f(t).elm);X(h,n.left,n.top,n.width/d.init.w),F(p,0),Y(function(){e=!(c.style.display="none"),w()})}}function b(t,n){ga("single"),g(n)}function $(t,n){if(ga("double.zoom: ",m),"out"!==m){v();var e=d.init;if("in"===m)X(h,e.x,e.y,1);else{var r=O({x:2*e.x-t.start[0].x,y:2*e.y-t.start[0].y,w:2*e.w,h:2*e.h}),i=r.x,o=r.y;X(h,i,o,2)}Y(function(){return y()})}}function _(t,n){if(""===m){var e=t.current[0].y-t.start[0].y;X(h,d.init.x,d.init.y+e,1);var r=1-Math.abs(2*e/P());F(p,0<r?r:0)}}function E(t,n){""===m&&(Math.abs(t.current[0].y-t.start[0].y)/P()>1/7?g(n):(v(),X(h,d.init.x,d.init.y,1),F(p,1),Y(function(){return y()})))}function z(t,n){var e,r=V((e=t).current[0],e.current[1])/V(e.start[0],e.start[1]),i=G(t.start[0],t.start[1]),o=G(t.current[0],t.current[1]),a=o.x-(i.x-d.start.x)*r,u=o.y-(i.y-d.start.y)*r,s=r*d.start.z;if(m=1<s?"in":s<1?"out":"",X(h,a,u,s),"out"===m){var c=B(f(n).elm);d.start.z<=1&&F(p,(d.current.w-c.width)/(d.init.w-c.width))}}function M(t,n){"out"===m&&(d.start.z<=1?g(n):x())}function H(t,n){var e=B(n);d.start.x=d.last.x=d.current.x=e.x,d.start.y=d.last.y=d.current.y=e.y,d.start.w=d.last.w=d.current.w=e.width,d.start.h=d.last.h=d.current.h=e.height;var r=d.start.z=d.last.z=d.current.z=e.width/d.init.w;m=1<r?"in":r<1?"out":""}function N(t,n){var e=B(n);d.current.x=e.x,d.current.y=e.y,d.current.w=e.width,d.current.h=e.height,d.current.z=e.width/d.init.w}function A(t,n,e){if("in"===m){var r=t.current[0].x-t.start[0].x+d.start.x,i=t.current[0].y-t.start[0].y+d.start.y;X(h,r,i,d.start.z)}}function L(t,n,e){if(e.is("pan")||e.is("pinch")){if("in"!==m)return;var r=d.current,i=O(r),o=i.x,a=i.y;if(o===r.x&&a===r.y)return;v(),X(h,o,a,r.z),Y(function(){return y()})}}function O(t){var n=t.x,e=t.y,r=t.w,i=t.h,o=U(),a=P();return r<o?n=(o-r)/2:0<n?n=0:n<o-r&&(n=o-r),i<a?e=(a-i)/2:0<e?e=0:e<a-i&&(e=a-i),{x:n,y:e}}}}),function(t,n,e){e.setAttribute("rel","stylesheet"),e.setAttribute("href",URL.createObjectURL(new Blob([4,0,6,0,5,0,7,0,30,8,1,4,0,6,0,5,0,7,0,25,8,1,4,0,6,0,5,0,7,0,17,8,1,4,0,6,0,5,0,7,0,38,8,1,4,0,6,0,5,0,7,0,56,8,1,4,0,6,0,5,0,7,0,54,8,1,4,0,6,0,5,0,7,0,55,13,23,3,20,2,24,3,20,2,34,3,33,11,1,48,37,2,63,3,33,11,1,48,37,2,12,9,4,0,6,0,5,0,7,0,30,8,1,4,0,6,0,5,0,7,0,25,8,1,4,0,6,0,5,0,7,0,17,8,1,4,0,6,0,5,0,7,0,38,13,57,3,62,2,12,9,4,0,6,0,5,0,7,0,30,13,66,3,14,2,16,3,65,2,49,10,60,3,68,2,58,3,14,2,28,10,32,3,14,2,26,10,29,3,14,2,12,9,4,0,6,0,5,0,7,0,25,13,16,3,19,2,67,3,70,69,2,27,3,35,1,42,36,1,40,10,41,22,44,8,1,20,8,1,45,8,1,43,21,2,35,3,20,2,12,9,4,0,6,0,5,0,7,0,17,13,16,3,19,2,18,10,59,3,24,1,23,2,27,3,18,1,42,36,1,40,10,41,22,44,8,1,20,8,1,45,8,1,43,21,2,28,10,32,3,14,2,26,10,29,3,14,2,12,9,4,0,6,0,5,0,7,0,17,1,61,13,34,3,33,11,2,28,10,32,3,14,2,26,10,29,3,14,2,12,9,4,0,6,0,5,0,7,0,31,13,16,3,19,2,24,3,15,11,2,23,3,15,11,2,18,3,53,22,10,15,11,8,1,10,15,11,21,2,12,46,47,1,4,31,10,64,1,13,9,1,1,16,3,1,19,2,9,1,1,24,3,1,15,11,2,9,1,1,18,3,1,52,22,10,15,11,21,2,9,12,9,9,4,31,10,50,1,13,9,1,1,16,3,1,19,2,9,1,1,23,3,1,15,11,2,9,1,1,18,3,1,51,22,10,15,11,21,2,9,12,1,47,46,9,4,0,6,0,5,0,7,0,39,1,4,0,6,0,5,0,7,0,25,8,1,4,0,6,0,5,0,7,0,39,1,4,0,6,0,5,0,7,0,17,13,27,3,14,2,12].map(function(t){return n[t]}),{type:"text/css"}))),URL.revokeObjectURL(e.getAttribute("href"))}(0,["_"," ",";",":",".","style","src","css",",","\n","-","%","}","{","none","50","position","wrap","transform","absolute","0",")","(","top","left","bg","user","transition","touch","select","gallery","center","action","100","width","opacity","ms","important","full","disableTransition","cubic","bezier","333","1","0.4","0.22","/","*","!","z","v","translateY","translateX","translate","swiperWrap","swiperItem","swiper","overflow","outline","origin","index","img","hidden","height","h","fixed","display","background","9999","000","#"],document.head.appendChild(document.createElement("link")));